## DOMä¼˜åŒ–åŸç†ä¸åŸºæœ¬å®è·µ

DOMä¸ºä»€ä¹ˆè¿™ä¹ˆæ…¢ï¼Ÿå¦‚ä½•ä½¿DOMå˜å¿«ï¼Ÿ

æ ¹æ®DOMç‰¹æ€§åŠæ¸²æŸ“åŸç†=ã€‹åŸºæœ¬çš„ä¼˜åŒ–æ€è·¯ï¼Œæ¶‰åŠä¸€éƒ¨åˆ†ç”Ÿäº§å®è·µ

â€œDOMä¼˜åŒ–æ€è·¯â€ã€â€œå¼‚æ­¥æ›´æ–°ç­–ç•¥â€ã€â€œå›æµä¸é‡ç»˜â€



### DOMä¸ºä»€ä¹ˆè¿™ä¹ˆæ…¢

#### å› ä¸ºæ”¶äº†â€œè¿‡è·¯è´¹â€

> æŠŠDOMå’ŒJavaScriptå„è‡ªæƒ³è±¡æˆä¸€ä¸ªå²›å±¿ï¼Œå®ƒä»¬ä¹‹é—´ç”¨æ”¶è´¹æ¡¥æ¢è¿æ¥ã€‚â€”â€”é«˜æ€§èƒ½JavaScript

JSå¾ˆå¿«ï¼Œåœ¨JSä¸­ä¿®æ”¹DOMå¯¹è±¡ä¹Ÿå¾ˆå¿«ã€‚**ä½†**DOMæ“ä½œå¹¶éJSä¸€ä¸ªäººçš„ç‹¬èˆï¼Œè€Œæ˜¯ä¸¤ä¸ªæ¨¡å—ä¹‹é—´çš„åä½œã€‚

å½“æˆ‘ä»¬ç”¨JSå»æ“ä½œDOMæ—¶ï¼Œ**æœ¬è´¨ä¸Šæ˜¯JSå¼•æ“å’Œæ¸²æŸ“å¼•æ“ä¹‹é—´è¿›è¡Œäº†â€œè·¨ç•Œäº¤æµâ€**ã€‚ä¾èµ–æ¡¥æ¥æ¥å£ä½œä¸ºâ€œæ¡¥æ¢â€ã€‚

![JSå¼•æ“ä¸æ¸²æŸ“å¼•æ“äº¤æµ.png](./JSå¼•æ“ä¸æ¸²æŸ“å¼•æ“äº¤æµ.png)

æ¯æ“ä½œä¸€æ¬¡DOMï¼ˆä¿®æ”¹æˆ–è®¿é—®ï¼‰ï¼Œéƒ½è¦è¿‡ä¸€æ¬¡æ¡¥ã€‚è¿‡æ¡¥çš„æ¬¡æ•°å¤šäº†ï¼Œå°±ä¼šäº§ç”Ÿæ¯”è¾ƒæ˜æ˜¾çš„æ€§èƒ½é—®é¢˜ã€‚=ã€‹â€œå‡å°‘DOMæ“ä½œâ€œ

#### å¯¹DOMçš„ä¿®æ”¹å¼•å‘æ ·å¼çš„æ›´è¿­

è¿‡æ¡¥å¾ˆæ…¢ï¼Œåˆ°äº†æ¡¥å¯¹å²¸ï¼Œæ›´å¾…æ“ä½œå¸¦æ¥çš„ç»“æœä¹Ÿå¾ˆæ…¢ã€‚

å¤šæ•°æ—¶å€™ï¼Œå¯¹DOMçš„æ“ä½œéƒ½ä¸ä¼šå±€é™äºè®¿é—®ï¼Œè€Œæ˜¯ä¸ºäº†ä¿®æ”¹ã€‚=ã€‹å¼•å‘DOMå¤–è§‚ï¼ˆæ ·å¼ï¼‰ä¸Šçš„æ”¹å˜æ—¶ï¼Œå°±ä¼šè§¦å‘**å›æµæˆ–é‡ç»˜**ã€‚=ã€‹æœ¬è´¨ä¸Šè¿˜æ˜¯å› ä¸ºå¯¹DOMçš„ä¿®æ”¹è§¦å‘äº†æ¸²æŸ“æ ‘ï¼ˆRender Treeï¼‰çš„å˜åŒ–æ‰€å¯¼è‡´çš„

![æ¸²æŸ“æ ‘å˜åŒ–.png](./æ¸²æŸ“æ ‘å˜åŒ–.png)

* å›æµï¼ˆä¹Ÿå«é‡æ’ï¼‰ï¼šå¯¹DOMçš„ä¿®æ”¹å¼•å‘äº†DOMå‡ ä½•å°ºå¯¸çš„å˜åŒ–ï¼ˆå¦‚å®½ã€é«˜æˆ–éšè—å…ƒç´ ç­‰ï¼‰æ—¶ï¼Œæµè§ˆå™¨éœ€è¦é‡æ–°è®¡ç®—å…ƒç´ çš„å‡ ä½•å±æ€§ï¼ˆå…¶ä»–å…ƒç´ çš„å‡ ä½•å±æ€§å’Œä½ç½®ä¹Ÿä¼šå› æ­¤å—å½±å“ï¼‰ï¼Œç„¶åå†å°†è®¡ç®—çš„ç»“æœç»˜åˆ¶å‡ºæ¥ã€‚
* é‡ç»˜ï¼šå¯¹DOMçš„ä¿®æ”¹å¯¼è‡´äº†æ ·å¼çš„å˜åŒ–ã€å´å¹¶æœªå½±å“å…¶å‡ ä½•å±æ€§ï¼ˆå¦‚é¢œè‰²æˆ–èƒŒæ™¯è‰²ç­‰ï¼‰æ—¶ï¼Œæµè§ˆå™¨ä¸éœ€è¦é‡æ–°è®¡ç®—å…ƒç´ çš„å‡ ä½•å±æ€§ã€ç›´æ¥ä¸ºè¯¥å…ƒç´ ç»˜åˆ¶æ–°çš„æ ·å¼ã€‚

**é‡ç»˜ä¸ä¸€å®šå¯¼è‡´å›æµï¼Œå›æµä¸€å®šä¼šå¯¼è‡´é‡ç»˜ã€‚**å›æµåšçš„äº‹æƒ…æ›´å¤šï¼Œå¸¦æ¥çš„å¼€é”€ä¹Ÿæ›´å¤§ã€‚éƒ½åƒæ€§èƒ½=ã€‹å°½å¯èƒ½æŠŠå›æµå’Œé‡ç»˜çš„æ¬¡æ•°æœ€å°åŒ–



### ç»™DOMâ€æé€Ÿâ€œ

#### å‡å°‘DOMæ“ä½œï¼šå°‘äº¤â€è¿‡è·¯è´¹â€œã€é¿å…è¿‡åº¦æ¸²æŸ“

1. **ç¼“å­˜å˜é‡**çš„æ–¹å¼ï¼ˆå˜é‡ç¼“å­˜DOMå…ƒç´ ï¼‰å‡å°‘è¿‡æ¡¥æ¬¡æ•°ã€‚

2. **å‡å°‘ä¸å¿…è¦çš„DOMæ›´æ”¹**ã€‚JSå±‚é¢çš„äº‹æƒ…å¤„ç†å¥½äº†ï¼Œå†å»åŠ¨DOMã€‚JSçš„è¿è¡Œé€Ÿåº¦æ¯”DOMå¿«å¾—å¤š=ã€‹è®©JSç»™DOMåˆ†å‹=ã€‹[DOM Fragment](https://developer.mozilla.org/zh-CN/docs/Web/API/DocumentFragment)    

   > DocumentFragmentæ¥å£è¡¨ç¤ºä¸€ä¸ªæ²¡æœ‰çˆ¶çº§æ–‡ä»¶çš„æœ€å°æ–‡æ¡£å¯¹è±¡ã€‚è¢«å½“åšä¸€ä¸ªè½»é‡ç‰ˆçš„Documentä½¿ç”¨ï¼Œç”¨äºå­˜å‚¨å·²æ’å¥½ç‰ˆçš„æˆ–å°šæœªæ‰“ç†å¥½æ ¼å¼çš„XMLç‰‡æ®µã€‚
   >
   > å› ä¸ºDocumentFragmentä¸æ˜¯çœŸå®DOMæ ‘çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒçš„å˜åŒ–ä¸ä¼šå¼•èµ·DOMæ ‘çš„é‡æ–°æ¸²æŸ“çš„æ“ä½œï¼Œä¸ä¼šå¯¼è‡´æ€§èƒ½ç­‰é—®é¢˜ã€‚

   æ— è®ºå­—ç¬¦ä¸²å˜é‡è¿˜æ˜¯DOM Fragmentï¼Œæœ¬è´¨ä¸Šéƒ½ä½œä¸ºè„±ç¦»äº†çœŸå®DOMæ ‘çš„**å®¹å™¨**å‡ºç°ï¼Œç”¨äºç¼“å­˜æ‰¹é‡åŒ–çš„DOMæ“ä½œã€‚

   DOM Fragmentï¼Œæ›´ä¼˜é›…ï¼Œä»¥æ›´åŠ ç»“æ„åŒ–çš„æ–¹å¼ï¼Œç»´æŒæ€§èƒ½çš„åŒæ—¶ï¼Œä¿ä½ä»£ç çš„å¯æ‹“å±•å’Œå¯ç»´æŠ¤æ€§ã€‚ğŸŒ°ï¼š

   ```javascript
   let container = document.getElementById('container');
   // åˆ›å»ºä¸€ä¸ªDOM Fragmentå¯¹è±¡ä½œä¸ºå®¹å™¨=ã€‹å…¼å®¹é—®é¢˜
   let content = document.createDocumentFragment();
   for (let count=0; count<10000; count++) {
     // spanæ­¤æ—¶å¯ä»¥é€šè¿‡DOM APIå»åˆ›å»º
     let oSpan = document.createElement("span");
     oSpan.innerHTML = 'æˆ‘æ˜¯ä¸€ä¸ªå°æµ‹è¯•';
     // åƒæ“ä½œçœŸå®DOMä¸€æ ·æ“ä½œDOM Fragmentå¯¹è±¡
     content.appendChild(oSpan);
   }
   // å†…å®¹å¤„ç†å¥½äº†ï¼Œæœ€åå†è§¦å‘çœŸå®DOMçš„æ›´æ”¹
   container.appendChild(content);
   ```

   DOM Fragmentå¯¹è±¡å…è®¸æˆ‘ä»¬**åƒæ“ä½œçœŸå®DOMä¸€æ ·**å»è°ƒç”¨å„ç§å„æ ·çš„DOM APIï¼Œä»£ç è´¨é‡å› æ­¤å¾—åˆ°äº†ä¿è¯ã€‚å®ƒçš„èº«ä»½ä¹Ÿéå¸¸çº¯ç²¹ï¼šå½“å°†å…¶appendè¿›çœŸå®DOMæ—¶ï¼Œä¼šåœ¨äº¤å‡ºè‡ªèº«ç¼“å­˜çš„æ‰€æœ‰çš„åä»£èŠ‚ç‚¹å**å…¨èº«è€Œé€€**ï¼Œå®Œç¾åœ°å®Œæˆä¸€ä¸ªå®¹å™¨çš„ä½¿å‘½ï¼Œè€Œä¸ä¼šå‡ºç°åœ¨çœŸå®çš„DOMç»“æ„ä¸­ã€‚ï¼ˆjQueryã€Vueç­‰ï¼‰



#### è¡¥å……

åˆ©ç”¨ç¼“å†²çš„æ€æƒ³å‡å°‘å¤šæ¬¡æ“ä½œå¼•èµ·çš„æ€§èƒ½å¼€é”€é—®é¢˜

createDocumentFragmenté€‚ç”¨äºå­å…ƒç´ æ²¡æœ‰çˆ¶å…ƒç´ çš„æƒ…å†µï¼Œå¦‚æœå­å…ƒç´ æœ‰ä¸€ä¸ªçˆ¶å…ƒç´ ï¼Œç›´æ¥createElementçˆ¶å…ƒç´ ç„¶åappendå°±å¯ä»¥äº†

å®é™…æ•°æ®ç»“æ„å¤æ‚ï¼Œæ•°é‡å¤šä¼šé˜»å¡ï¼Œè€ƒè™‘åˆ†æ‰¹å¾ªç¯ï¼Œå¦‚ï¼šåªæ¸²æŸ“å¯è§†åŒºåŸŸçš„dom

å˜é‡çš„ç¼“å­˜å¯¹domé‡ç»˜æ²¡æœ‰æœ¬è´¨å½±å“ï¼Œç¼“å­˜å˜é‡è¿˜ä¼šä½¿è„šæœ¬å¤§å°å¢åŠ ï¼Œå¤šæ¬¡é‡ç»˜å˜æˆä¸€æ¬¡é‡ç»˜ï¼Œæ‰æ˜¯ä¸€ä¼˜åŒ–çš„å®è´¨ã€‚æ—¢è¦å…³æ³¨é‡ç»˜å¸¦æ¥çš„è€—æ—¶ï¼Œä¹Ÿè¦å…³æ³¨è„šæœ¬å¤§å°å¸¦æ¥çš„å½±å“ã€‚ï¼Ÿ

